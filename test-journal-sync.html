<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Journal Sync Test</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body { padding: 2rem; font-family: Arial, sans-serif; }
        .test-section { 
            margin-bottom: 2rem; 
            border: 1px solid #ddd; 
            padding: 1rem; 
        }
        .day-button { 
            margin-right: 0.5rem; 
            display: inline-flex;
            width: 32px;
            height: 32px;
        }
        #console { 
            background: #f5f5f5; 
            padding: 1rem; 
            border: 1px solid #ddd; 
            margin-top: 1rem;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 0.8rem;
        }
        .analytics-tile {
            display: inline-block;
            padding: 1rem;
            margin: 0.5rem;
            border: 1px solid #ddd;
            min-width: 100px;
            text-align: center;
        }
        .heatmap-cell {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin: 2px;
            border: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <h1>Journal ‚Üí Analytics Sync Test</h1>
    
    <!-- Simulate Journal Day Buttons -->
    <div class="test-section">
        <h3>üìù Journal Day Tracking</h3>
        <p>Sport:</p>
        <div class="day-button" data-type="sport" data-day="1">MO</div>
        <div class="day-button" data-type="sport" data-day="2">DI</div>
        <div class="day-button" data-type="sport" data-day="3">MI</div>
        <div class="day-button" data-type="sport" data-day="4">DO</div>
        <div class="day-button" data-type="sport" data-day="5">FR</div>
        <div class="day-button" data-type="sport" data-day="6">SA</div>
        <div class="day-button" data-type="sport" data-day="0">SO</div>
        
        <p>Nutrition:</p>
        <div class="day-button" data-type="nutrition" data-day="1">MO</div>
        <div class="day-button" data-type="nutrition" data-day="2">DI</div>
        <div class="day-button" data-type="nutrition" data-day="3">MI</div>
        <div class="day-button" data-type="nutrition" data-day="4">DO</div>
        <div class="day-button" data-type="nutrition" data-day="5">FR</div>
        <div class="day-button" data-type="nutrition" data-day="6">SA</div>
        <div class="day-button" data-type="nutrition" data-day="0">SO</div>
        
        <p>Work7am:</p>
        <div class="day-button" data-type="work7am" data-day="1">MO</div>
        <div class="day-button" data-type="work7am" data-day="2">DI</div>
        <div class="day-button" data-type="work7am" data-day="3">MI</div>
        <div class="day-button" data-type="work7am" data-day="4">DO</div>
        <div class="day-button" data-type="work7am" data-day="5">FR</div>
    </div>

    <!-- Simulate Home Monthly Tiles -->
    <div class="test-section">
        <h3>üè† Home Monthly Tiles</h3>
        <div class="analytics-tile">
            <div id="sportStreakCount">0</div>
            <div>Sport</div>
        </div>
        <div class="analytics-tile">
            <div id="nutritionStreakCount">0</div>
            <div>Ern√§hrung</div>
        </div>
        <div class="analytics-tile">
            <div id="workStreakCount">0</div>
            <div>7 Uhr Arbeit</div>
        </div>
    </div>

    <!-- Simulate Analytics Heatmap -->
    <div class="test-section">
        <h3>üìä Analytics Heatmap (4 Wochen)</h3>
        <div id="sport-heatmap-container" data-type="sport">
            <p>Sport Heatmap:</p>
            <div class="heatmap-cell heat-0" data-day="1" data-type="sport" data-week="31"></div>
            <div class="heatmap-cell heat-0" data-day="2" data-type="sport" data-week="31"></div>
            <div class="heatmap-cell heat-0" data-day="3" data-type="sport" data-week="31"></div>
            <div class="heatmap-cell heat-0" data-day="4" data-type="sport" data-week="31"></div>
            <div class="heatmap-cell heat-0" data-day="5" data-type="sport" data-week="31"></div>
        </div>
    </div>
    
    <div id="console">Console output...</div>

    <script>
        function log(message) {
            const consoleDiv = document.getElementById('console');
            const timestamp = new Date().toLocaleTimeString();
            consoleDiv.innerHTML += `[${timestamp}] ${message}<br>`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
            console.log(message);
        }

        // Simulate the journal day button functionality
        let weeklyTrackingData = {
            sport: new Set(),
            nutrition: new Set(), 
            work7am: new Set()
        };

        function updateMonthlyTiles() {
            // Simulate monthly counting
            document.getElementById('sportStreakCount').textContent = weeklyTrackingData.sport.size;
            document.getElementById('nutritionStreakCount').textContent = weeklyTrackingData.nutrition.size;
            document.getElementById('workStreakCount').textContent = weeklyTrackingData.work7am.size;
            
            log(`Monthly tiles updated: Sport=${weeklyTrackingData.sport.size}, Nutrition=${weeklyTrackingData.nutrition.size}, Work7am=${weeklyTrackingData.work7am.size}`);
        }

        function updateAnalyticsHeatmap(type, day, isSelected) {
            const heatmapCell = document.querySelector(`[data-type="${type}"][data-day="${day}"]`);
            if (heatmapCell && heatmapCell.classList.contains('heatmap-cell')) {
                heatmapCell.className = isSelected ? 'heatmap-cell heat-100' : 'heatmap-cell heat-0';
                heatmapCell.style.background = isSelected ? '#000' : '#f5f5f5';
                log(`Analytics heatmap updated: ${type} day ${day} = ${isSelected ? 'active' : 'inactive'}`);
            } else {
                log(`Analytics heatmap cell not found: ${type} day ${day}`);
            }
        }

        function initializeDayTracking() {
            const dayButtons = document.querySelectorAll('.day-button');
            log(`Initializing ${dayButtons.length} day buttons`);
            
            dayButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const type = this.getAttribute('data-type');
                    const day = this.getAttribute('data-day');
                    const isSelected = this.classList.contains('selected');
                    
                    log(`Button clicked: ${type} day ${day} (was ${isSelected ? 'selected' : 'unselected'})`);
                    
                    // Toggle selection
                    if (isSelected) {
                        this.classList.remove('selected');
                        weeklyTrackingData[type].delete(day);
                    } else {
                        this.classList.add('selected');
                        weeklyTrackingData[type].add(day);
                    }
                    
                    const newState = !isSelected;
                    log(`Button toggled to: ${newState ? 'selected' : 'unselected'}`);
                    
                    // Update monthly tiles
                    updateMonthlyTiles();
                    
                    // Update analytics heatmap
                    updateAnalyticsHeatmap(type, day, newState);
                });
            });
            
            // Initial update
            updateMonthlyTiles();
        }

        document.addEventListener('DOMContentLoaded', function() {
            log('DOM loaded - starting journal sync test');
            initializeDayTracking();
        });
    </script>
</body>
</html>